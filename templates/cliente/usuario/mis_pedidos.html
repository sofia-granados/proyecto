<!-- app_mascotas/templates/cliente/usuario/mis_pedidos.html -->
{% extends 'cliente/base_cliente.html' %}

{% block title %}{{ titulo }}{% endblock %}

{% block content %}
<div class="container">
    <h1 style="margin-bottom: 30px;">{{ titulo }}</h1>
    
    {% if pedidos %}
    <div class="table-container">
        <table>
            <thead>
                <tr>
                    <th>NÂ° Pedido</th>
                    <th>Fecha</th>
                    <th>Total</th>
                    <th>Estado</th>
                    <th>Acciones</th>
                </tr>
            </thead>
            <tbody>
                {% for pedido in pedidos %}
                <tr>
                    <td>
                        <strong>{{ pedido.numero_pedido|default:"Sin nÃºmero" }}</strong>
                    </td>
                    <td>{{ pedido.fecha_pedido|date:"d/m/Y H:i" }}</td>
                    <td>${{ pedido.total|floatformat:2|default:"0.00" }}</td>
                    <td>
                        {% if pedido.estado == 'pendiente' %}
                        <span class="badge badge-pendiente">Pendiente</span>
                        {% elif pedido.estado == 'pagado' %}
                        <span class="badge badge-pagado">Pagado</span>
                        {% elif pedido.estado == 'enviado' %}
                        <span class="badge badge-enviado">Enviado</span>
                        {% elif pedido.estado == 'entregado' %}
                        <span class="badge badge-entregado">Entregado</span>
                        {% elif pedido.estado == 'cancelado' %}
                        <span class="badge badge-cancelado">Cancelado</span>
                        {% else %}
                        <span class="badge">{{ pedido.estado|default:"Sin estado"|title }}</span>
                        {% endif %}
                    </td>
                    <td>
                        <!-- SOLUCIÃ“N: Usar pedido.id en lugar de pedido.id_pedido -->
                        {% if pedido.id %}
                        <a href="{% url 'cliente:detalle_mi_pedido' pedido_id=pedido.id %}" 
                           class="btn" style="background: #e2e8f0; color: #4a5568; padding: 5px 10px; font-size: 0.9rem; text-decoration: none;">
                            Ver Detalles
                        </a>
                        {% else %}
                        <span style="color: #718096; font-size: 0.9rem;">No disponible</span>
                        {% endif %}
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    {% else %}
    <div class="alert" style="background: #e2e8f0; padding: 20px; border-radius: 8px; text-align: center;">
        <p style="margin-bottom: 10px;">ðŸ“­ No tienes pedidos registrados</p>
        <a href="{% url 'cliente:index_cliente' %}" class="btn" style="background: #667eea; color: white;">
            Â¡Explora nuestros productos!
        </a>
    </div>
    {% endif %}
</div>

<style>
    .badge {
        padding: 5px 10px;
        border-radius: 20px;
        font-size: 12px;
        font-weight: 600;
        display: inline-block;
    }
    
    .badge-pendiente {
        background: #fed7d7;
        color: #c53030;
    }
    
    .badge-pagado {
        background: #bee3f8;
        color: #2c5282;
    }
    
    .badge-enviado {
        background: #fefcbf;
        color: #744210;
    }
    
    .badge-entregado {
        background: #c6f6d5;
        color: #22543d;
    }
    
    .badge-cancelado {
        background: #e2e8f0;
        color: #4a5568;
    }
    
    .btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        transition: all 0.3s ease;
    }
</style>
{% endblock %}