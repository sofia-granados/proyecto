<!-- templates/cliente/navbar_cliente.html -->
<nav style="background: white; padding: 15px 0; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
    <!-- JUSTO despu√©s de abrir el nav -->
<div style="background: yellow; padding: 5px; margin-bottom: 10px; text-align: center;">
    üîç DEBUG: usuario_autenticado = {{ usuario_autenticado|yesno:"TRUE,FALSE" }} | 
    usuario_nombre = "{{ usuario_nombre }}" |
    URL mis_pedidos = {% url 'cliente:mis_pedidos' %}
</div>
    <div class="container">
        <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 15px;">
            <!-- Navegaci√≥n principal -->
            <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                <!-- Bot√≥n INICIO -->
                <a href="{% url 'cliente:index_cliente' %}" class="btn" style="background: #e2e8f0; color: #4a5568;">Inicio</a>
                
                <!-- Bot√≥n MASCOTAS -->
                <a href="{% url 'cliente:lista_categoria' categoria_id=3 %}" class="btn" style="background: #e2e8f0; color: #4a5568;">
                    Mascotas
                </a>
                
                <!-- Bot√≥n ALIMENTOS -->
                <a href="{% url 'cliente:lista_categoria' categoria_id=1 %}" class="btn" style="background: #e2e8f0; color: #4a5568;">
                    Alimentos
                </a>
                
                <!-- Bot√≥n ACCESORIOS -->
                <a href="{% url 'cliente:lista_categoria' categoria_id=2 %}" class="btn" style="background: #e2e8f0; color: #4a5568;">
                    Accesorios
                </a>
            </div>
            
            <!-- Acciones de usuario -->
            <div style="display: flex; gap: 10px; align-items: center;">
                <!-- CARRITO -->
                <a href="{% url 'cliente:ver_carrito' %}" class="btn btn-primary" 
                   style="display: flex; align-items: center; gap: 5px; position: relative;">
                    üõí Carrito
                    {% if carrito_total_items > 0 %}
                    <span style="background: white; color: #667eea; padding: 2px 8px; border-radius: 12px; font-size: 0.8rem; position: absolute; top: -8px; right: -8px;">
                        {{ carrito_total_items }}
                    </span>
                    {% endif %}
                </a>
                
                <!-- USUARIO NO AUTENTICADO -->
                {% if not usuario_autenticado %}
                <a href="{% url 'cliente:login_cliente' %}" class="btn" style="background: #e2e8f0; color: #4a5568;">
                    Iniciar Sesi√≥n
                </a>
                <a href="{% url 'cliente:registro_cliente' %}" class="btn btn-secondary">
                    Crear Cuenta
                </a>
                
                <!-- USUARIO AUTENTICADO -->
                {% else %}
                <div style="position: relative; display: inline-block;">
                    <button class="btn btn-secondary" id="user-menu-button" style="display: flex; align-items: center; gap: 5px;">
                        üë§ Hola, {{ usuario_nombre|truncatechars:15 }}
                        <span style="font-size: 0.8rem;">‚ñº</span>
                    </button>
                    <div id="user-menu" style="display: none; position: absolute; right: 0; background: white; min-width: 220px; box-shadow: 0 8px 16px rgba(0,0,0,0.2); z-index: 1000; border-radius: 8px; padding: 10px 0; margin-top: 5px;">
                        
                        <!-- Informaci√≥n del usuario -->
                        <div style="padding: 10px 15px; color: #718096; border-bottom: 1px solid #e2e8f0;">
                            <div style="font-weight: bold; color: #4a5568;">{{ usuario_nombre }}</div>
                            <small>{{ usuario_correo }}</small>
                        </div>
                        
                        <!-- MIS PEDIDOS -->
                        <a href="{% url 'cliente:mis_pedidos' %}" 
                           style="display: flex; align-items: center; gap: 8px; padding: 12px 15px; color: #333; text-decoration: none; border-left: 4px solid #1890ff;">
                            <span style="font-size: 1.2rem;">üì¶</span>
                            <div>
                                <strong style="color: #1890ff;">Mis Pedidos</strong>
                                <div style="font-size: 0.8rem; color: #718096;">Ver historial de compras</div>
                            </div>
                        </a>
                        
                        <!-- Mi Perfil -->
                        <a href="{% url 'cliente:perfil_usuario' %}" 
                           style="display: flex; align-items: center; gap: 8px; padding: 12px 15px; color: #333; text-decoration: none;">
                            <span style="font-size: 1.2rem;">üë§</span>
                            <div>
                                <strong>Mi Perfil</strong>
                                <div style="font-size: 0.8rem; color: #718096;">Editar mis datos</div>
                            </div>
                        </a>
                        
                        <!-- Cerrar Sesi√≥n -->
                        <a href="{% url 'cliente:logout_cliente' %}" 
                           style="display: flex; align-items: center; gap: 8px; padding: 12px 15px; color: #f56565; text-decoration: none; border-top: 1px solid #e2e8f0; margin-top: 5px;">
                            <span style="font-size: 1.2rem;">üö™</span>
                            <div>
                                <strong>Cerrar Sesi√≥n</strong>
                            </div>
                        </a>
                    </div>
                </div>
                {% endif %}  <!-- üî• IMPORTANTE: Cierra el if -->
            </div>
        </div>
    </div>
</nav>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // Men√∫ desplegable para usuario autenticado
    const userMenuButton = document.getElementById('user-menu-button');
    const userMenu = document.getElementById('user-menu');
    
    if (userMenuButton && userMenu) {
        userMenuButton.addEventListener('click', function(e) {
            e.stopPropagation();
            userMenu.style.display = userMenu.style.display === 'block' ? 'none' : 'block';
        });
        
        // Cerrar men√∫ al hacer clic fuera
        document.addEventListener('click', function() {
            userMenu.style.display = 'none';
        });
        
        // Evitar que se cierre al hacer clic dentro del men√∫
        userMenu.addEventListener('click', function(e) {
            e.stopPropagation();
        });
    }
});
console.log('üîç DEBUG NAVBAR:');
console.log('  usuario_autenticado:', {{ usuario_autenticado|yesno:"true,false" }});
console.log('  usuario_nombre:', "{{ usuario_nombre }}");

// Verificar que los elementos existan
const userMenuButton = document.getElementById('user-menu-button');
const userMenu = document.getElementById('user-menu');

console.log('  Bot√≥n existe:', !!userMenuButton);
console.log('  Men√∫ existe:', !!userMenu);

if (userMenuButton) {
    console.log('  Bot√≥n HTML:', userMenuButton.outerHTML);
}

// Forzar mostrar el men√∫ TEMPORALMENTE para debug
setTimeout(() => {
    if (userMenu) {
        userMenu.style.display = 'block';
        userMenu.style.position = 'fixed';
        userMenu.style.top = '100px';
        userMenu.style.right = '50px';
        userMenu.style.zIndex = '99999';
        console.log('üîç Men√∫ forzado a mostrar');
    }
}, 1000);
</script>